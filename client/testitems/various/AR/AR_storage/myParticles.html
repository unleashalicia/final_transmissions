<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Finale Test</title>
    <link rel="stylesheet" type="text/css" href="../../../../assets/css/ARstyle.css"/>


    <script src="../../../../assets/lib/aframe.js"></script>
    <script src="../../../../assets/lib/aframe-ar.js"></script>
</head>
<body style='margin : 0px; overflow: hidden;'>

<a-scene embedded artoolkit='sourceType: webcam;'>
    <!--<a-sky color="grey"></a-sky>-->

    <a-assets>
        <img id="wood" src="../../../../assets/images/wood.jpg"/>
    </a-assets>

    <a-marker preset='hiro'>

        <a-entity>
            <a-box src="#wood" height="1" width="1" depth="1" position="0 0.5 0" rotation="0 0 0">
            </a-box>
        </a-entity>

        <a-entity
            id="white"
            light="color: white;
            type: directional;
            intensity: 1.0"
            position="0 0 9"
            rotation="0 0 90"
            target="0 0 0"
        >
        </a-entity>

        <a-entity
            id="blue"
            light="color: #3A43D4;
            type: directional;
            intensity: 1.0"
            position="9 0 0"
            rotation="90 0 0"
            target="0 0 0"
        >
        </a-entity>
        <a-entity
            id="green"
            light="color: #185900;
            type: directional;
            intensity: 1.0"
            position="0 0 -9"
            rotation="180 0 0"
            target="0 0 0"
        >
        </a-entity>
        <a-entity
            id="red"
            light="color: #AC0406;
            type: directional;
            intensity: 1.0"
            position="-9 0 0"
            rotation="270 0 0"
            target="0 0 0"
        >
        </a-entity>
    </a-marker>


</a-scene>

<script>




    window.addEventListener("load", function () {
        createSpheres(200);
    });

    const findRange = (start, end) => {
        return (Math.random() * (end-start) ) + start;
    };



    const createSpheres = (amount) => {
        const marker = document.querySelector('a-marker');

        for (let creator=0; creator<amount; creator++) {
            let entity = document.createElement('a-entity');
            let sphere = document.createElement('a-sphere');
            let move = document.createElement('a-animation');
            let fade = document.createElement('a-animation');
            let random = Math.random();
            let posXdest = null;
            let color = null;
            let posYdest = findRange(5, 7);
            let dur = findRange(200, 3000);
            let radius = findRange(0.025, 0.07);



            if (random < .2){
                posXdest = findRange(-1, 1);
                color = "grey";
            } else if (random < .7){
                posXdest = findRange(-2, 2);
                color = "white";
            } else if (random < .95){
                posXdest = findRange(-3, 3);
                color = "white";
            } else {
                posXdest = findRange(-4, 4);
                color = "white";
            }


            sphere.setAttribute('material', 'color', color);
            sphere.setAttribute('opacity', '0.7');

            sphere.setAttribute('radius', radius);

            move.setAttribute('attribute', 'position');
            move.setAttribute('dur', dur);
            move.setAttribute('from', '0' + ' ' + '0.5' + ' 0');
            move.setAttribute('to', posXdest + ' ' + posYdest + ' 0');
            move.setAttribute('easing', 'linear');
            move.setAttribute('repeat', 'indefinite');

            fade.setAttribute('attribute', 'opacity');
            fade.setAttribute('dur', dur);
            fade.setAttribute('from', '0.7');
            fade.setAttribute('to', '0');
            fade.setAttribute('easing', 'linear');
            fade.setAttribute('repeat', 'indefinite');


            entity.appendChild(move);
            sphere.appendChild(fade);
            entity.appendChild(sphere);
            marker.appendChild(entity);



        }
    }




//    //var sphereEl = document.createElement('a-sphere');
//    //sphereEl.setAttribute('radius', 0.5);
//    //sphereEl.setAttribute('material', 'color', 'blue');
//    //sphereEl.setAttribute('position', {x: 0, y: 1, z:-5});
//    //document.querySelector('a-scene').appendChild(sphereEl);
//    //sphereEl.addEventListener('loaded', function () {
//    //    console.log('sphere attached');
//    //});
//

</script>

</body>
</html>